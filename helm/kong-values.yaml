replicaCount: 2

labels:
  app.kubernetes.io/instance: kong

podDisruptionBudget:
  enabled: true
  minAvailable: 1
ingressController:
  enabled: true
  env:
    KONGHQ_COM_GLOBAL_PLUGINS: true
image:
  repository: localhost:5000/kong-oidc
  tag: "3.11-ubuntu"
  pullPolicy: IfNotPresent
proxy:
  type: NodePort
  http:
    nodePort: 30080
  tls:
    enabled: true
    nodePort: 30443
  resources:
    requests:
      cpu: "100m"
      memory: "128Mi"
      ephemeral-storage: "25Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"
      ephemeral-storage: "50Mi"
    enabled: true
  trusted_ips: "103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,104.16.0.0/13,104.24.0.0/14,108.162.192.0/18,131.0.72.0/22,141.101.64.0/18,162.158.0.0/15,172.64.0.0/13,173.245.48.0/20,188.114.96.0/20,190.93.240.0/20,197.234.240.0/22,198.41.128.0/17"
  real_ip_header: "X-Forwarded-For"
  real_ip_recursive: true
admin:
  enabled: false
  http:
    enabled: false
deployment:
  kong:
    resources:
      requests:
        cpu: "250m"
        memory: "512Mi"
        ephemeral-storage: "256Mi"
      limits:
        cpu: "1"
        memory: "1Gi"
        ephemeral-storage: "1Gi"
migrations:
  resources:
    requests:
      cpu: "200m"
      memory: "256Mi"
      ephemeral-storage: "256Mi"
    limits:
      cpu: "1"
      memory: "512Mi"
      ephemeral-storage: "1Gi"
env:
  database: postgres
  pg_host: pg-cluster-rw.default.svc.cluster.local
  pg_database: app
  pg_user:
    valueFrom:
      secretKeyRef:
        name: pg-cluster-app
        key: username
  pg_password:
    valueFrom:
      secretKeyRef:
        name: pg-cluster-app
        key: password
  redis_host: "redis-master.default.svc.cluster.local"
  redis_port: 6379
  KONG_OIDC_CLIENT_SECRET:
    valueFrom:
      secretKeyRef:
        name: oidc-client-secret
        key: client-secret
  plugins: "bundled,oidcify,cors,rate-limiting,ip-restriction"
  pluginserver_names: oidcify
  pluginserver_oidcify_start_cmd: "/usr/local/bin/oidcify -kong-prefix /kong_prefix"
  pluginserver_oidcify_query_cmd: "/usr/local/bin/oidcify -dump"
  KONG_TRUSTED_IPS: "103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,104.16.0.0/13,104.24.0.0/14,108.162.192.0/18,131.0.72.0/22,141.101.64.0/18,162.158.0.0/15,172.64.0.0/13,173.245.48.0/20,188.114.96.0/20,190.93.240.0/20,197.234.240.0/22,198.41.128.0/17"
  KONG_REAL_IP_HEADER: "X-Forwarded-For"
  KONG_REAL_IP_RECURSIVE: "on"
  KONG_HEADERS_UPSTREAM: "X-Forwarded-Proto:https,X-Forwarded-Host:$host"
  VAULT_ENV_PREFIX: "KONG_"
